nl←'
'
nums←{⍎¨(nl∘≠⊆⊢)⍵}

base1←(↓+.>⊢↓⍨-⍤⊣)
s1a←1∘base1∘nums
s1b←3∘base1∘nums

s2a←{
  f d u←↓'f' 'd' 'u'∘.{(⍎⊃⌽⍵)×⍺=⊃⊃⍵}(' '∘≠⊆⊢)¨(nl∘≠⊆⊢)⍵
  +/f×+/d-u
}
s2b←{
  f d u←↓'f' 'd' 'u'∘.{(⍎⊃⌽⍵)×⍺=⊃⊃⍵}(' '∘≠⊆⊢)¨(nl∘≠⊆⊢)⍵
}
